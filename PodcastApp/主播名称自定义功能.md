# 主播名称自定义功能

## 功能说明

播客生成时，主播会使用音色的实际名称介绍自己，而不是"主播A"或"主播B"。

## 示例

### 修改前
```
主播A：大家好，我是主播A，今天我们来聊聊...
主播B：大家好，我是主播B，这个话题很有意思...
```

### 修改后
```
小何：大家好，我是小何，今天我们来聊聊...
云舟：大家好，我是云舟，这个话题很有意思...
```

## 实现原理

### 1. 音色名称提取

从音色ID中提取简短的名称：

| 音色ID | 完整名称 | 提取的名称 |
|--------|---------|-----------|
| `zh_female_xiaohe_uranus_bigtts` | 小何 2.0 | 小何 |
| `zh_male_taocheng_uranus_bigtts` | 小天 2.0 | 小天 |
| `zh_female_vv_uranus_bigtts` | Vivi 2.0 | Vivi |
| `zh_male_m191_uranus_bigtts` | 云舟 2.0 | 云舟 |
| `zh_female_shuangkuaisisi_moon_bigtts` | 双快思思 | 双快思思 |

提取规则：
- 如果名称包含空格（如"小何 2.0"），取第一部分（"小何"）
- 如果名称不包含空格（如"双快思思"），使用完整名称

### 2. LLM提示词更新

在生成播客脚本时，将主播名称传递给LLM：

```swift
func generatePodcastScript(
    articles: [RSSArticle],
    topics: [String],
    length: Int,
    style: String,
    depth: String,
    hostAName: String = "主播A",  // 新增参数
    hostBName: String = "主播B",  // 新增参数
    progressHandler: ((String) -> Void)? = nil
) async throws -> String
```

提示词示例：
```
要求：
1. 生成两个主播（小何和云舟）的对话
2. 对话要自然、有趣，符合轻松闲聊的风格
3. 格式：每行一个对话，格式为"小何：内容"或"云舟：内容"
4. 主播在介绍自己时，直接说"我是小何"或"我是云舟"，不要说"我是主播A"或"我是主播B"
```

### 3. 脚本解析增强

更新脚本解析逻辑，支持识别任意主播名称：

```swift
/// 解析播客脚本
/// 支持格式：
/// - "主播A：内容" 或 "主播A:内容"
/// - "主播B：内容" 或 "主播B:内容"
/// - "小何：内容" 或 "小何:内容"（自定义主播名）
/// - "云舟：内容" 或 "云舟:内容"（自定义主播名）
private func parseScript(_ script: String) -> [Dialogue]
```

解析规则：
1. 查找冒号（`：`或`:`）分隔符
2. 提取主播名称和对话内容
3. 判断是主播A还是主播B：
   - 包含"A"或"主播A" → 主播A
   - 包含"B"或"主播B" → 主播B
   - 其他情况 → 根据对话顺序交替分配

### 4. 不同TTS引擎的主播名称

| TTS引擎 | 主播A名称 | 主播B名称 | 说明 |
|---------|----------|----------|------|
| 豆包TTS | 从音色ID提取 | 从音色ID提取 | 如：小何、云舟 |
| 豆包播客API | 从音色ID提取 | 从音色ID提取 | 如：双快思思、温暖阿虎 |
| 系统TTS | 婷婷 | 辛吉 | 固定名称 |
| OpenAI TTS | Alloy | Echo | 使用音色名称首字母大写 |
| ElevenLabs | 主播A | 主播B | 使用默认名称 |

## 代码修改

### 1. LLMService.swift
- 添加`hostAName`和`hostBName`参数
- 更新提示词，使用自定义主播名称

### 2. PodcastService.swift
- 添加`getHostNames(from:)`方法，从配置中提取主播名称
- 添加`extractVoiceName(from:resourceId:)`方法，从音色ID提取名称
- 在调用`generatePodcastScript`时传递主播名称

### 3. TTSService.swift
- 更新`parseScript`方法，支持识别任意主播名称
- 使用智能规则判断主播A/B

## 测试

运行测试脚本验证功能：

```bash
swift test_host_names.swift
```

测试内容：
1. 音色名称提取
2. 脚本解析

## 用户体验改进

### 修改前
- 主播介绍："大家好，我是主播A"
- 听起来机械、不自然

### 修改后
- 主播介绍："大家好，我是小何"
- 听起来更自然、更有亲和力
- 与实际音色名称一致

## 未来扩展

可以考虑：
1. 允许用户自定义主播名称（不使用音色名称）
2. 支持更多语言的主播名称
3. 根据主播性别自动选择合适的称呼
