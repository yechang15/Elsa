# å‘¨æœŸç”Ÿæˆæ’­å®¢åŠŸèƒ½

## åŠŸèƒ½æ¦‚è¿°

æ·»åŠ äº†å‘¨æœŸç”Ÿæˆæ’­å®¢çš„é…ç½®åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥è®¾ç½®æ¯å¤©åœ¨æŒ‡å®šæ—¶é—´è‡ªåŠ¨ç”Ÿæˆæ’­å®¢ã€‚

## åŠŸèƒ½ç‰¹æ€§

### 1. ç”Ÿæˆé¢‘ç‡é€‰é¡¹

- **æ¯å¤©**ï¼šæ¯å¤©éƒ½ç”Ÿæˆæ’­å®¢
- **å·¥ä½œæ—¥**ï¼šå‘¨ä¸€è‡³å‘¨äº”ç”Ÿæˆ
- **å‘¨æœ«**ï¼šå‘¨å…­ã€å‘¨æ—¥ç”Ÿæˆ
- **è‡ªå®šä¹‰**ï¼šè‡ªå®šä¹‰å‘¨æœŸï¼ˆé¢„ç•™æ¥å£ï¼‰

### 2. ç”Ÿæˆæ—¶é—´é…ç½®

- æ”¯æŒè®¾ç½®å…·ä½“çš„ç”Ÿæˆæ—¶é—´ï¼ˆå¦‚ 08:00ï¼‰
- 24å°æ—¶åˆ¶æ ¼å¼ï¼ˆHH:mmï¼‰
- è‡ªåŠ¨éªŒè¯æ—¶é—´æ ¼å¼

### 3. æ’­å®¢åˆ—è¡¨æ˜¾ç¤º

åœ¨æ’­å®¢åˆ—è¡¨é¡¶éƒ¨æ˜¾ç¤ºè‡ªåŠ¨ç”Ÿæˆé…ç½®å¡ç‰‡ï¼ŒåŒ…å«ï¼š
- ç”Ÿæˆé¢‘ç‡
- ç”Ÿæˆæ—¶é—´
- é…ç½®çš„è¯é¢˜æ•°é‡
- ä¸‹æ¬¡ç”Ÿæˆæ—¶é—´ï¼ˆæ™ºèƒ½è®¡ç®—ï¼‰

## é…ç½®æ¨¡å‹

### UserConfig æ–°å¢å­—æ®µ

```swift
struct UserConfig: Codable, Equatable {
    // ... å…¶ä»–é…ç½®

    // æ’­å®¢ç”Ÿæˆé…ç½®
    var autoGenerate: Bool = true
    var autoGenerateTime: String = "08:00"
    var autoGenerateFrequency: AutoGenerateFrequency = .daily  // æ–°å¢
    var autoGenerateTopics: [String] = []  // æ–°å¢ï¼šè¯é¢˜IDåˆ—è¡¨
}
```

### ç”Ÿæˆé¢‘ç‡æšä¸¾

```swift
enum AutoGenerateFrequency: String, Codable, CaseIterable {
    case daily = "æ¯å¤©"
    case weekdays = "å·¥ä½œæ—¥"
    case weekends = "å‘¨æœ«"
    case custom = "è‡ªå®šä¹‰"

    var description: String {
        switch self {
        case .daily:
            return "æ¯å¤©ç”Ÿæˆ"
        case .weekdays:
            return "å‘¨ä¸€è‡³å‘¨äº”ç”Ÿæˆ"
        case .weekends:
            return "å‘¨å…­ã€å‘¨æ—¥ç”Ÿæˆ"
        case .custom:
            return "è‡ªå®šä¹‰å‘¨æœŸ"
        }
    }
}
```

## UI å®ç°

### 1. è®¾ç½®é¡µé¢

åœ¨"æ’­å®¢ç”Ÿæˆ"éƒ¨åˆ†æ·»åŠ ï¼š

```swift
Toggle("è‡ªåŠ¨ç”Ÿæˆ", isOn: $localAutoGenerate)

if localAutoGenerate {
    VStack(alignment: .leading, spacing: 12) {
        // ç”Ÿæˆé¢‘ç‡
        Picker("ç”Ÿæˆé¢‘ç‡", selection: $localAutoGenerateFrequency) {
            ForEach(AutoGenerateFrequency.allCases, id: \.self) { frequency in
                Text(frequency.rawValue).tag(frequency)
            }
        }

        // ç”Ÿæˆæ—¶é—´
        HStack {
            Text("ç”Ÿæˆæ—¶é—´")
            Spacer()
            TextField("HH:mm", text: $localAutoGenerateTime)
                .frame(width: 80)
        }

        Text("æç¤ºï¼šæ¯å¤©ï¼Œåœ¨ 08:00 è‡ªåŠ¨ç”Ÿæˆæ’­å®¢")
            .font(.caption)
            .foregroundColor(.secondary)
    }
}
```

### 2. æ’­å®¢åˆ—è¡¨é…ç½®å¡ç‰‡

```swift
struct AutoGenerateConfigCard: View {
    let config: UserConfig

    var body: some View {
        HStack(spacing: 12) {
            // å›¾æ ‡
            Image(systemName: "clock.arrow.circlepath")
                .font(.system(size: 24))
                .foregroundColor(.green)

            VStack(alignment: .leading, spacing: 4) {
                Text("è‡ªåŠ¨ç”Ÿæˆå·²å¯ç”¨")
                    .font(.subheadline)
                    .fontWeight(.semibold)

                HStack(spacing: 8) {
                    Text(config.autoGenerateFrequency.rawValue)
                    Text("Â·")
                    Text(config.autoGenerateTime)
                    Text("Â·")
                    Text("\(config.autoGenerateTopics.count) ä¸ªè¯é¢˜")
                }
                .font(.caption)
                .foregroundColor(.secondary)
            }

            Spacer()

            // ä¸‹æ¬¡ç”Ÿæˆæ—¶é—´
            VStack(alignment: .trailing, spacing: 4) {
                Text("ä¸‹æ¬¡ç”Ÿæˆ")
                    .font(.caption2)
                    .foregroundColor(.secondary)

                Text(nextGenerateTime)
                    .font(.caption)
                    .fontWeight(.medium)
                    .foregroundColor(.green)
            }
        }
        .padding()
        .background(Color.green.opacity(0.1))
        .cornerRadius(12)
    }
}
```

## ä¸‹æ¬¡ç”Ÿæˆæ—¶é—´è®¡ç®—

æ™ºèƒ½è®¡ç®—ä¸‹æ¬¡ç”Ÿæˆæ—¶é—´çš„é€»è¾‘ï¼š

```swift
private var nextGenerateTime: String {
    // 1. è§£æé…ç½®çš„æ—¶é—´
    let targetTime = parseTime(config.autoGenerateTime)

    // 2. è·å–ä»Šå¤©çš„ç›®æ ‡æ—¶é—´
    var nextDate = getTodayTargetDate(targetTime)

    // 3. å¦‚æœä»Šå¤©çš„æ—¶é—´å·²è¿‡ï¼Œè·³åˆ°æ˜å¤©
    if nextDate <= now {
        nextDate = addDay(nextDate)
    }

    // 4. æ ¹æ®é¢‘ç‡è°ƒæ•´
    switch config.autoGenerateFrequency {
    case .daily:
        // æ¯å¤©éƒ½ç”Ÿæˆï¼Œä¸éœ€è¦è°ƒæ•´
        break
    case .weekdays:
        // å¦‚æœæ˜¯å‘¨æœ«ï¼Œè·³åˆ°ä¸‹å‘¨ä¸€
        while isWeekend(nextDate) {
            nextDate = addDay(nextDate)
        }
    case .weekends:
        // å¦‚æœæ˜¯å·¥ä½œæ—¥ï¼Œè·³åˆ°å‘¨æœ«
        while !isWeekend(nextDate) {
            nextDate = addDay(nextDate)
        }
    case .custom:
        // è‡ªå®šä¹‰é€»è¾‘
        break
    }

    // 5. æ ¼å¼åŒ–æ˜¾ç¤º
    if isToday(nextDate) {
        return "ä»Šå¤© 08:00"
    } else if isTomorrow(nextDate) {
        return "æ˜å¤© 08:00"
    } else {
        return "12-25 08:00"
    }
}
```

## æ˜¾ç¤ºæ•ˆæœ

### æ’­å®¢åˆ—è¡¨é¡¶éƒ¨å¡ç‰‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”„  è‡ªåŠ¨ç”Ÿæˆå·²å¯ç”¨                               â”‚
â”‚     æ¯å¤© Â· 08:00 Â· 3 ä¸ªè¯é¢˜          ä¸‹æ¬¡ç”Ÿæˆ    â”‚
â”‚                                      ä»Šå¤© 08:00  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è®¾ç½®é¡µé¢

```
æ’­å®¢ç”Ÿæˆ
â”œâ”€ é»˜è®¤é•¿åº¦: 15åˆ†é’Ÿ
â”œâ”€ å†…å®¹æ·±åº¦: å¿«é€Ÿæµè§ˆ
â”œâ”€ ä¸»æ’­é£æ ¼: è½»æ¾é—²èŠ
â””â”€ â˜‘ è‡ªåŠ¨ç”Ÿæˆ
   â”œâ”€ ç”Ÿæˆé¢‘ç‡: æ¯å¤©
   â”œâ”€ ç”Ÿæˆæ—¶é—´: 08:00
   â””â”€ æç¤ºï¼šæ¯å¤©ï¼Œåœ¨ 08:00 è‡ªåŠ¨ç”Ÿæˆæ’­å®¢
```

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šæ¯å¤©æ—©æ™¨æ’­å®¢

```
é…ç½®ï¼š
- é¢‘ç‡ï¼šæ¯å¤©
- æ—¶é—´ï¼š08:00
- è¯é¢˜ï¼šç§‘æŠ€æ–°é—»ã€ç¼–ç¨‹æŠ€æœ¯

æ•ˆæœï¼š
æ¯å¤©æ—©ä¸Š8ç‚¹è‡ªåŠ¨ç”Ÿæˆä¸€æœŸæ’­å®¢ï¼ŒåŒ…å«æœ€æ–°çš„ç§‘æŠ€å’Œç¼–ç¨‹å†…å®¹
```

### åœºæ™¯2ï¼šå·¥ä½œæ—¥é€šå‹¤æ’­å®¢

```
é…ç½®ï¼š
- é¢‘ç‡ï¼šå·¥ä½œæ—¥
- æ—¶é—´ï¼š07:30
- è¯é¢˜ï¼šå•†ä¸šèµ„è®¯ã€è¡Œä¸šåŠ¨æ€

æ•ˆæœï¼š
å‘¨ä¸€è‡³å‘¨äº”æ—©ä¸Š7:30ç”Ÿæˆæ’­å®¢ï¼Œå‘¨æœ«ä¸ç”Ÿæˆ
```

### åœºæ™¯3ï¼šå‘¨æœ«ä¼‘é—²æ’­å®¢

```
é…ç½®ï¼š
- é¢‘ç‡ï¼šå‘¨æœ«
- æ—¶é—´ï¼š10:00
- è¯é¢˜ï¼šç”Ÿæ´»æ–¹å¼ã€å¨±ä¹å…«å¦

æ•ˆæœï¼š
å‘¨å…­ã€å‘¨æ—¥æ—©ä¸Š10ç‚¹ç”Ÿæˆæ’­å®¢ï¼Œå·¥ä½œæ—¥ä¸ç”Ÿæˆ
```

## åç»­å®ç°

### 1. å®šæ—¶ä»»åŠ¡è°ƒåº¦

éœ€è¦å®ç°åå°å®šæ—¶ä»»åŠ¡ï¼Œåœ¨æŒ‡å®šæ—¶é—´è‡ªåŠ¨è§¦å‘æ’­å®¢ç”Ÿæˆï¼š

```swift
class PodcastScheduler {
    func scheduleAutoGenerate(config: UserConfig) {
        // ä½¿ç”¨ Timer æˆ– DispatchQueue å®ç°å®šæ—¶ä»»åŠ¡
        // åœ¨æŒ‡å®šæ—¶é—´è§¦å‘ PodcastService.generatePodcast()
    }

    func cancelAutoGenerate() {
        // å–æ¶ˆå®šæ—¶ä»»åŠ¡
    }
}
```

### 2. è¯é¢˜é€‰æ‹©

åœ¨è®¾ç½®é¡µé¢æ·»åŠ è¯é¢˜é€‰æ‹©å™¨ï¼Œè®©ç”¨æˆ·é€‰æ‹©è‡ªåŠ¨ç”Ÿæˆæ—¶ä½¿ç”¨å“ªäº›è¯é¢˜ï¼š

```swift
// è¯é¢˜é€‰æ‹©å™¨
MultiSelector("é€‰æ‹©è¯é¢˜", selection: $selectedTopics) {
    ForEach(topics) { topic in
        Text(topic.name).tag(topic.id)
    }
}
```

### 3. ç”Ÿæˆå†å²

è®°å½•æ¯æ¬¡è‡ªåŠ¨ç”Ÿæˆçš„å†å²ï¼š

```swift
struct AutoGenerateHistory {
    let date: Date
    let topics: [String]
    let success: Bool
    let errorMessage: String?
}
```

### 4. é€šçŸ¥æé†’

ç”Ÿæˆå®Œæˆåå‘é€ç³»ç»Ÿé€šçŸ¥ï¼š

```swift
func sendNotification() {
    let content = UNMutableNotificationContent()
    content.title = "æ’­å®¢ç”Ÿæˆå®Œæˆ"
    content.body = "ä»Šå¤©çš„æ’­å®¢å·²ç»å‡†å¤‡å¥½äº†ï¼"
    content.sound = .default
}
```

## æ³¨æ„äº‹é¡¹

1. **æ—¶é—´æ ¼å¼éªŒè¯**ï¼šç¡®ä¿ç”¨æˆ·è¾“å…¥çš„æ—¶é—´æ ¼å¼æ­£ç¡®ï¼ˆHH:mmï¼‰
2. **æ—¶åŒºå¤„ç†**ï¼šä½¿ç”¨æœ¬åœ°æ—¶åŒºè®¡ç®—ç”Ÿæˆæ—¶é—´
3. **é”™è¯¯å¤„ç†**ï¼šå¦‚æœç”Ÿæˆå¤±è´¥ï¼Œåº”è¯¥è®°å½•é”™è¯¯å¹¶é€šçŸ¥ç”¨æˆ·
4. **èµ„æºç®¡ç†**ï¼šé¿å…åœ¨åº”ç”¨æœªè¿è¡Œæ—¶å°è¯•ç”Ÿæˆæ’­å®¢
5. **é…ç½®æŒä¹…åŒ–**ï¼šç¡®ä¿é…ç½®æ­£ç¡®ä¿å­˜åˆ° UserDefaults

## æµ‹è¯•å»ºè®®

1. æµ‹è¯•ä¸åŒé¢‘ç‡çš„æ—¶é—´è®¡ç®—
2. æµ‹è¯•è·¨å¤©ã€è·¨å‘¨çš„æ—¶é—´è®¡ç®—
3. æµ‹è¯•æ—¶é—´æ ¼å¼éªŒè¯
4. æµ‹è¯•é…ç½®ä¿å­˜å’ŒåŠ è½½
5. æµ‹è¯•UIæ˜¾ç¤ºçš„æ­£ç¡®æ€§
