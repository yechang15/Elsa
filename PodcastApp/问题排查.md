# 火山引擎TTS集成问题排查

## 当前问题

WebSocket连接失败，HTTP 401 Unauthorized

错误信息：
```json
{"error":"load grant: requested grant not found in SaaS storage"}
```

## 问题原因

凭证认证失败，可能的原因：

1. **凭证不正确** - App ID 或 Access Token 输入错误
2. **凭证已过期** - Access Token 可能有有效期
3. **服务未开通** - 需要在火山引擎控制台开通"语音合成"服务
4. **凭证类型不匹配** - 提供的凭证可能是其他服务的凭证

## 排查步骤

### 1. 确认凭证来源

请确认凭证是从以下位置获取的：
- 火山引擎控制台：https://console.volcengine.com/speech/service
- 服务类型：语音合成（TTS）
- API类型：双向流式TTS

### 2. 检查服务状态

登录火山引擎控制台，确认：
- [ ] 语音合成服务已开通
- [ ] 应用状态为"正常"
- [ ] Access Token 未过期
- [ ] 账户余额充足（如果是付费服务）

### 3. 重新生成凭证

如果凭证可能有问题，建议：
1. 在控制台中创建新的应用
2. 生成新的 Access Token
3. 记录新的 App ID 和 Access Token
4. 在应用设置中更新凭证

### 4. 验证凭证

使用以下命令测试凭证是否有效：

```bash
curl -s -H "X-Api-App-Key: YOUR_APP_ID" \
     -H "X-Api-Access-Key: YOUR_ACCESS_TOKEN" \
     -H "X-Api-Resource-Id: seed-tts-2.0" \
     "https://openspeech.bytedance.com/api/v3/tts/bidirection"
```

如果返回 401 错误，说明凭证无效。

### 5. 参考文档

- 控制台使用FAQ：https://www.volcengine.com/docs/6561/196768
- 双向流式TTS文档：https://www.volcengine.com/docs/6561/1257544

## 当前测试的凭证

```
App ID: YOUR_APP_ID
Access Token: YOUR_ACCESS_TOKEN
Resource ID: seed-tts-2.0
```

测试结果：❌ 认证失败

## 下一步

请提供：
1. 凭证的获取截图（可以遮挡敏感信息）
2. 控制台中服务的状态
3. 或者重新生成一组新的凭证

## 代码状态

✅ 代码实现已完成
✅ 二进制帧格式正确
✅ WebSocket连接逻辑正确
⏳ 等待有效的凭证进行测试

一旦获得有效凭证，应该可以立即工作。
